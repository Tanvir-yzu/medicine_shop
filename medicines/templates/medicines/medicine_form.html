{% extends 'medicines/base.html' %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<section class="max-w-2xl mx-auto px-4">
  <div class="bg-white dark:bg-slate-900 rounded-2xl shadow-xl shadow-slate-200/40 dark:shadow-black/40 p-6 md:p-8">
    
    <h2 class="text-3xl font-extrabold text-slate-800 dark:text-slate-100 mb-6">
      {{ title }}
    </h2>

    {% if scanned_data %}
      <div class="bg-indigo-50 dark:bg-indigo-900/40 border border-indigo-200 dark:border-indigo-800
                  text-indigo-700 dark:text-indigo-300 rounded-xl p-4 mb-6">
        <p class="font-semibold">New medicine detected</p>
        <p class="text-sm mt-1">
          The code <strong>{{ scanned_data }}</strong> wasnâ€™t found.
          Review the details and save when ready.
        </p>
      </div>
    {% endif %}

    <form method="post" class="space-y-5">
      {% csrf_token %}
      {{ form.non_field_errors }}

      {% for field in form %}
        <div>
          <label for="{{ field.id_for_label }}"
                 class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1.5">
            {{ field.label }}
            {% if field.field.required %}
              <span class="text-rose-500">*</span>
            {% endif %}
          </label>

          {{ field.as_widget|safe }}

          <script>
            document.getElementById("{{ field.id_for_label }}")?.classList.add(
              "w-full","px-3.5","py-2.5","rounded-lg",
              "border","border-slate-300","dark:border-slate-700",
              "bg-white","dark:bg-slate-800",
              "text-slate-900","dark:text-slate-100",
              "placeholder:text-slate-400","dark:placeholder:text-slate-500",
              "focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",
              "transition"
            );
          </script>

          {% if field.errors %}
            <p class="text-rose-500 text-xs mt-1">{{ field.errors.0 }}</p>
          {% endif %}

          {% if field.help_text %}
            <p class="text-slate-500 dark:text-slate-400 text-xs mt-1">
              {{ field.help_text }}
            </p>
          {% endif %}
        </div>
      {% endfor %}

      <div class="flex flex-col-reverse sm:flex-row sm:justify-end gap-3 pt-4">
        <a href="{% url 'medicine_list' %}"
           class="px-4 py-2.5 rounded-lg text-sm font-medium
                  border border-slate-300 dark:border-slate-700
                  text-slate-700 dark:text-slate-200
                  bg-white dark:bg-slate-800
                  hover:bg-slate-50 dark:hover:bg-slate-700 transition">
          Cancel
        </a>

        <button type="submit"
                class="px-5 py-2.5 rounded-lg text-sm font-semibold
                       text-white bg-indigo-600 hover:bg-indigo-500
                       focus:outline-none focus:ring-2 focus:ring-indigo-500
                       focus:ring-offset-2 dark:focus:ring-offset-slate-900 transition">
          Save
        </button>
      </div>
    </form>
  </div>
</section>
{% endblock %}
